; Start logging
logopen 'C:\LRDE\HIL_Demo\hil_test_output.log'

; Connect to Arduino
connect '/C=COM3 /BAUD=9600'
if result != 2 then
  messagebox 'ERROR: Failed to connect to COM3.'
  logclose
  end
endif

; Wait for READY
timeout = 10
wait 'READY'
if result != 0 then
  messagebox 'ERROR: READY not received.'
  logclose
  end
endif

; Send test command
sendln 'RUN_TESTS'

; Wait for completion
wait 'TEST_COMPLETE'
if result != 0 then
  messagebox 'ERROR: TEST_COMPLETE not received.'
  logclose
  end
endif

; Final log
logwrite 'HIL_TEST_FINISHED'
logclose
closett
